%h5 Greeter Wizard

%h3.user-name= @user.name
=link_to("ðŸ‘ˆ Back", admin_users_url, class: "user-back btn btn-secondary")
= link_to("ðŸ™‚ Profile", @user.profile_url, class: "user-profile-button btn btn-primary #{@user.profile_url ? "" : "hidden"}", target: "_blank")
= link_to("ðŸ’¬ Chat", @user.chat_url, class: "user-chat-button btn btn-primary #{@user.chat_url ? "" : "hidden"}", target: "_blank")
- patch_url = admin_user_patch_url(token: @user.token)

- if "Scheduling Zoom" == @user.status
  %h3
    = "Scheduling a Zoom Greeting"
  -# greeter can compose chat message to send or copy / paste
  -# button for "Meeting Scheduled" to go to next page
  .user-email{ data: {url: patch_url, token: @token, id: @user.id} }
    %input.email-subject.form-control{ placeholder: "Subject" }
    %textarea.email-body.form-control{ placeholder: "Body of greeting" }
    =link_to "Send Email", "#", class: "btn btn-primary email-template-send"
    .email-template-buttons Template buttons will be visible here
    %p="Email: #{link_to @user.email, "mailto:#{ @user.email }", class: "email-address"}"
  =link_to "Zoom Scheduled", admin_user_wizard_path(token: @user.token, done: "schedule-zoom"), class: "btn btn-primary"
  .next-url.hidden= admin_user_wizard_path(token: @user.token, done: "email-sent")


- if "Zoom Scheduled" == @user.status
  %h2.wizard Record the date and time for your greeting
  -# greeter can enter date and time for meeting
  -# button for "Meeting Done" to go to congratulatory completed page
  .user-meeting-datetime{ data: {url: patch_url, token: @token, id: @user.id, timestamp: @user.when_timestamp, greeter_id: @user.greeter_id } }
    - datetime = @user.when_timestamp ? @user.when_timestamp.picker_datetime : nil
    %input.datetime-picker.utc-time.form-control{ type: "text", value: datetime }
    %br
    - url = admin_user_wizard_path(token: @user.token, done: "zoom-scheduled")
    - if "Zoom Scheduled" == @user.status
      - url = admin_user_wizard_path(token: @user.token, done: "greeting-done")
      =link_to "Greeting Done", url, class: "btn btn-primary greeting-done"



-# make answers to questions available throughout the process
%br= link_to "Reveal answers to questions", "#", class: "reveal-answers #{@user.joined? ? nil : "hidden"}"
.user-questions{ class: @user.joined? ? "hidden" : "", data: {url: patch_url, token: @token, id: @user.id} }
  %h3= "#{@user.name}'s Answers to Questions"
  %ol.questions-and-answers
    - (@user.questions_responses || []).split(" -:- ").each do |qna|
      - q, a = *qna.split("\\")
      %li
        %span.question= q
        %br
        %span.answer= a
  - unless @user.joined? || "Request Declined" == @user.status
    - url = admin_approve_user_path(token: @user.token)
    = link_to "Answers Are Acceptable", url, class: "btn btn-primary user-approve"
    = link_to "Answers Need Clarification", "#", class: "btn btn-warning user-reject"
    .lds-hourglass#spinner
    %span.progress-message Working ...

.user-notes
  %h3 Notes
  %p (Record anything here that a greeter might need to know, in case you need to turn over this greeting)
  %textarea= @user.notes
  %span.save-status


= link_to "Show Details", admin_user_path(token: @user.token), class: "small-text"